{% extends "layout.html" %}
{% block title %}Grimoire — Légendes{% endblock %}
{% block content %}
<h1>Grimoire des Légendes</h1>

<section class="grimoire-area" style="background-image: url('{{ url_for('static', filename='images/grimoire.png') }}');">
  <div class="grimoire-content">
    <h2>Page {{ page }} / {{ pages }}</h2>

    <article class="legend-text">
      {{ legend_text | safe }}
    </article>

    <div class="pagination">
      {% if page > 1 %}
        <a href="/{{ lang }}/legendes?page={{ page-1 }}">← Précédent</a>
      {% endif %}
      {% if page < pages %}
        <a href="/{{ lang }}/legendes?page={{ page+1 }}">Suivant →</a>
      {% endif %}
    </div>
  </div>
</section>

<section class="comments">
  <h3>Commentaires</h3>
  {% for c in comments %}
    <div class="comment"><strong>{{ c.author }}</strong> : {{ c.text }}</div>
  {% else %}
    <div>Aucun commentaire pour l'instant.</div>
  {% endfor %}
  <form action="/{{ lang }}/comment" method="post">
    <input type="hidden" name="index" value="{{ page-1 }}">
    <input type="text" name="author" placeholder="Votre nom (facultatif)">
    <textarea name="comment" rows="3" placeholder="Votre commentaire..."></textarea>
    <button type="submit">Envoyer</button>
  </form>
</section>

<section class="admin-edit">
  <h3>Édition (Administrateurs)</h3>
  <form method="post" action="/{{ lang }}/legendes">
    <textarea name="legend_text" rows="10" placeholder="Écris la légende ici..."></textarea><br>
    <label>Index à modifier (laisser vide pour créer) :
      <input type="text" name="edit_index" placeholder="ex: {{ page }}">
    </label>
    <input type="password" name="password" placeholder="Mot de passe admin">
    <button type="submit">Enregistrer</button>
  </form>
</section>
{% endblock %}
